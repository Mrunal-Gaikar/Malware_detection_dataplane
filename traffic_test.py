#malicious traffic
from scapy.all import *
import random


#packet = IP(src="10.0.1.1",dst="10.0.2.2")/TCP(sport=2222,dport=443,flags=flags[num1])/Raw(RandString(size=lengths[num2]))
i=1

while(i<=50):

    
    flags1=["SA","S"]  #malicious
    length1=[65,139,65,143,136,20]
    num3 = random.randint(0,1)
    num4 = random.randint(0,5)
    """
    packet = IP(src="10.1.1.2",dst="10.1.2.2")/TCP(sport=2222,dport=443,flags=flags1[num3])/Raw(RandString(size=4))
    send(packet)
    packet1 = IP(src="10.1.1.2",dst="10.1.2.2")/TCP(sport=2222,dport=443,flags="PA")/Raw(RandString(size=length1[num4]))
    send(packet1)
    """
    flags = ["A","U","R","P","PU"] #non malicious
    flags2=["PA","SA"]
    len2=[260,8]
    lengths = [34,26,34,25,440,500]
    len1=[260,140,24,10,480,440,510,490]
    num1 = random.randint(0,4)
    num2 = random.randint(0,7)
    num5 = random.randint(0,5)
   
    packet2 = IP(src="10.1.1.2",dst="10.1.2.2")/TCP(sport=2222,dport=443,flags=flags[num1])/Raw(RandString(size=lengths[num5]))
    send(packet2)
    #packet3 = IP(src="10.1.1.2",dst="10.1.2.2")/TCP(sport=2222,dport=443,flags=flags1[num3])/Raw(RandString(size=len1[num2]))
    #send(packet3)
    packet4 = IP(src="10.1.1.2",dst="10.1.2.2")/TCP(sport=2222,dport=443,flags="PA")/Raw(RandString(size=len1[num2]))
    send(packet4)
    
    i=i+1

   
   






